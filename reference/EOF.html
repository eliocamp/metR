<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Empirical Orthogonal Function — EOF • metR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Empirical Orthogonal Function — EOF"><meta property="og:description" content="Computes Singular Value Decomposition (also known as Principal Components
Analysis or Empirical Orthogonal Functions)."><meta property="og:image" content="https://eliocamp.github.io/metR/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">metR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.15.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Visualization-tools.html">Visualization tools</a>
    </li>
    <li>
      <a href="../articles/Working-with-data.html">Working with data</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/eliocamp/metR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Empirical Orthogonal Function</h1>
    <small class="dont-index">Source: <a href="https://github.com/eliocamp/metR/blob/master/R/EOF.R" class="external-link"><code>R/EOF.R</code></a></small>
    <div class="hidden name"><code>EOF.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes Singular Value Decomposition (also known as Principal Components
Analysis or Empirical Orthogonal Functions).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">EOF</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>lower <span class="op">=</span> <span class="fl">0.025</span>, mid <span class="op">=</span> <span class="fl">0.5</span>, upper <span class="op">=</span> <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>  rotate <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  suffix <span class="op">=</span> <span class="st">"PC"</span>,</span>
<span>  fill <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  engine <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>a formula to build the matrix that will be used in the SVD
decomposition (see Details)</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>which singular values to return (if <code>NULL</code>, returns all)</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a data.frame</p></dd>


<dt id="arg-b">B<a class="anchor" aria-label="anchor" href="#arg-b"></a></dt>
<dd><p>number of bootstrap samples used to estimate confidence intervals.
Ignored if &lt;= 1.</p></dd>


<dt id="arg-probs">probs<a class="anchor" aria-label="anchor" href="#arg-probs"></a></dt>
<dd><p>the probabilities of the lower and upper values of estimated
confidence intervals. If named, it's names will be used as column names.</p></dd>


<dt id="arg-rotate">rotate<a class="anchor" aria-label="anchor" href="#arg-rotate"></a></dt>
<dd><p>a function to apply to the loadings to rotate them. E.g. for
varimax rotation use <code><a href="https://rdrr.io/r/stats/varimax.html" class="external-link">stats::varimax</a></code>.</p></dd>


<dt id="arg-suffix">suffix<a class="anchor" aria-label="anchor" href="#arg-suffix"></a></dt>
<dd><p>character to name the principal components</p></dd>


<dt id="arg-fill">fill<a class="anchor" aria-label="anchor" href="#arg-fill"></a></dt>
<dd><p>value to infill implicit missing values or <code>NULL</code> if the
data is dense.</p></dd>


<dt id="arg-engine">engine<a class="anchor" aria-label="anchor" href="#arg-engine"></a></dt>
<dd><p>function to use to compute SVD. If <code>NULL</code> it uses <a href="https://rdrr.io/pkg/irlba/man/irlba.html" class="external-link">irlba::irlba</a>
(if installed) if the largest singular value to compute is lower than half the maximum
possible value, otherwise it uses <a href="https://rdrr.io/r/base/svd.html" class="external-link">base::svd</a>. If the user provides a function,
it needs to be a drop-in replacement for <a href="https://rdrr.io/r/base/svd.html" class="external-link">base::svd</a> (the same arguments and
output format).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>An <code>eof</code> object which is just a named list of <code>data.table</code>s</p><dl><dt>left</dt>
<dd><p>data.table with left singular vectors</p></dd>

<dt>right</dt>
<dd><p>data.table with right singular vectors</p></dd>

<dt>sdev</dt>
<dd><p>data.table with singular values, their explained variance,
and, optionally, quantiles estimated via bootstrap</p></dd>


</dl><p>There are some methods implemented</p><ul><li><p><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></p></li>
<li><p><a href="https://rdrr.io/r/stats/screeplot.html" class="external-link">screeplot</a> and the equivalent <a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></p></li>
<li><p><a href="cut.eof.html">cut.eof</a></p></li>
<li><p><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>Singular values can be computed over matrices so <code>formula</code> denotes how
to build a matrix from the data. It is a formula of the form VAR ~ LEFT | RIGHT
(see <a href="https://rdrr.io/pkg/Formula/man/Formula.html" class="external-link">Formula::Formula</a>) in which VAR is the variable whose values will
populate the matrix, and LEFT represent the variables used to make the rows
and RIGHT, the columns of the matrix. Think it like "VAR <em>as a function</em> of
LEFT <em>and</em> RIGHT". The variable combination used in this formula <em>must</em> identify
an unique value in a cell.</p>
<p>So, for example, <code>v ~ x + y | t</code> would mean that there is one value of <code>v</code> for
each combination of <code>x</code>, <code>y</code> and <code>t</code>, and that there will be one row for
each combination of <code>x</code> and <code>y</code> and one row for each <code>t</code>.</p>
<p>In the result, the left and right vectors have dimensions of the LEFT and RIGHT
part of the <code>formula</code>, respectively.</p>
<p>It is much faster to compute only some singular vectors, so is advisable not
to set n to <code>NULL</code>. If the irlba package is installed, EOF uses
<a href="https://rdrr.io/pkg/irlba/man/irlba.html" class="external-link">irlba::irlba</a> instead of <a href="https://rdrr.io/r/base/svd.html" class="external-link">base::svd</a> since it's much faster.</p>
<p>The bootstrapping procedure follows Fisher et.al. (2016) and returns the
standard deviation of each singular value.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Fisher, A., Caffo, B., Schwartz, B., &amp; Zipunnikov, V. (2016). Fast, Exact Bootstrap Principal Component Analysis for p &gt; 1 million. Journal of the American Statistical Association, 111(514), 846–860. <a href="https://doi.org/10.1080/01621459.2015.1062383" class="external-link">doi:10.1080/01621459.2015.1062383</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other meteorology functions:
<code><a href="Derivate.html">Derivate</a>()</code>,
<code><a href="GeostrophicWind.html">GeostrophicWind</a>()</code>,
<code><a href="WaveFlux.html">WaveFlux</a>()</code>,
<code><a href="thermodynamics.html">thermodynamics</a></code>,
<code><a href="waves.html">waves</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># The Antarctic Oscillation is computed from the</span></span></span>
<span class="r-in"><span><span class="co"># monthly geopotential height anomalies weighted by latitude.</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">geopotential</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">geopotential</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">geopotential</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">geopotential</span><span class="op">[</span>, <span class="va">gh.t.w</span> <span class="op">:=</span> <span class="fu"><a href="Anomaly.html">Anomaly</a></span><span class="op">(</span><span class="va">gh</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">lat</span><span class="op">*</span><span class="va">pi</span><span class="op">/</span><span class="fl">180</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      by <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/IDateTime.html" class="external-link">month</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           lon   lat   lev       gh       date        gh.t.w</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         &lt;num&gt; &lt;num&gt; &lt;int&gt;    &lt;num&gt;     &lt;Date&gt;         &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1:   0.0 -22.5   700 3163.839 1990-01-01 -3.824174e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      2:   2.5 -22.5   700 3162.516 1990-01-01 -3.591582e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      3:   5.0 -22.5   700 3162.226 1990-01-01 -2.862909e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      4:   7.5 -22.5   700 3162.323 1990-01-01 -2.403045e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      5:  10.0 -22.5   700 3163.097 1990-01-01 -2.067122e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ---                                                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 290300: 347.5 -90.0   700 2671.484 1995-12-01 -1.449750e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 290301: 350.0 -90.0   700 2671.484 1995-12-01 -1.449750e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 290302: 352.5 -90.0   700 2671.484 1995-12-01 -1.449750e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 290303: 355.0 -90.0   700 2671.484 1995-12-01 -1.449750e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 290304: 357.5 -90.0   700 2671.484 1995-12-01 -1.449750e-07</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">eof</span> <span class="op">&lt;-</span> <span class="fu">EOF</span><span class="op">(</span><span class="va">gh.t.w</span> <span class="op">~</span> <span class="va">lat</span> <span class="op">+</span> <span class="va">lon</span> <span class="op">|</span> <span class="va">date</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, data <span class="op">=</span> <span class="va">geopotential</span>,</span></span>
<span class="r-in"><span>           B <span class="op">=</span> <span class="fl">100</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>low <span class="op">=</span> <span class="fl">0.1</span>, hig <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Inspect the explained variance of each component</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">eof</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Importance of components:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Component Explained variance Cumulative variance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       1                   32%                 32%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       2                   11%                 43%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       3                    8%                 51%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       4                    7%                 58%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       5                    6%                 64%</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/screeplot.html" class="external-link">screeplot</a></span><span class="op">(</span><span class="va">eof</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="EOF-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Keep only the 1st.</span></span></span>
<span class="r-in"><span><span class="va">aao</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">eof</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># AAO field</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">aao</span><span class="op">$</span><span class="va">left</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, z <span class="op">=</span> <span class="va">gh.t.w</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html" class="external-link">geom_contour</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">level</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_polar.html" class="external-link">coord_polar</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="EOF-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># AAO signal</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">aao</span><span class="op">$</span><span class="va">right</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">gh.t.w</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="EOF-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># standard deviation, % of explained variance and</span></span></span>
<span class="r-in"><span><span class="co"># confidence intervals.</span></span></span>
<span class="r-in"><span><span class="va">aao</span><span class="op">$</span><span class="va">sdev</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       PC       sd        r2     low      hig</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    &lt;ord&gt;    &lt;num&gt;     &lt;num&gt;   &lt;num&gt;    &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:   PC1 7050.352 0.3176266 6284.91 7899.572</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Reconstructed fields based only on the two first</span></span></span>
<span class="r-in"><span><span class="co"># principal components</span></span></span>
<span class="r-in"><span><span class="va">field</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">eof</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare it to the real field.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">field</span><span class="op">[</span><span class="va">date</span> <span class="op">==</span> <span class="va">date</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="geom_contour_fill.html">geom_contour_fill</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>z <span class="op">=</span> <span class="va">gh.t.w</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">geopotential</span><span class="op">[</span><span class="va">date</span> <span class="op">==</span> <span class="va">date</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="geom_contour2.html">geom_contour2</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>z <span class="op">=</span> <span class="va">gh.t.w</span>, linetype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">stat</a></span><span class="op">(</span><span class="va">level</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="scale_divergent.html">scale_fill_divergent</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>`stat(level)` was deprecated in ggplot2 3.4.0.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Please use `after_stat(level)` instead.</span>
<span class="r-plt img"><img src="EOF-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Elio Campitelli.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

