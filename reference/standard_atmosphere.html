<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Standard atmosphere — sa_pressure • metR</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Standard atmosphere — sa_pressure" />
<meta property="og:description" content="Utilities to use the International Standard Atmosphere. It uses the
International Standard Atmosphere up to the tropopause (11 km by definition)
and then extends up to the 500 km using the ARDC Model Atmosphere." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">metR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.11.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Visualization-tools.html">Visualization tools</a>
    </li>
    <li>
      <a href="../articles/Working-with-data.html">Working with data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/eliocamp/metR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Standard atmosphere</h1>
    <small class="dont-index">Source: <a href='https://github.com/eliocamp/metR/blob/master/R/standard_atmosphere.R'><code>R/standard_atmosphere.R</code></a></small>
    <div class="hidden name"><code>standard_atmosphere.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Utilities to use the International Standard Atmosphere. It uses the
International Standard Atmosphere up to the tropopause (11 km by definition)
and then extends up to the 500 km using the ARDC Model Atmosphere.</p>
    </div>

    <pre class="usage"><span class='fu'>sa_pressure</span><span class='op'>(</span><span class='va'>height</span><span class='op'>)</span>

<span class='fu'>sa_height</span><span class='op'>(</span><span class='va'>pressure</span><span class='op'>)</span>

<span class='fu'>sa_temperature</span><span class='op'>(</span><span class='va'>height</span><span class='op'>)</span>

<span class='fu'>sa_height_trans</span><span class='op'>(</span>pressure_in <span class='op'>=</span> <span class='st'>"hPa"</span>, height_in <span class='op'>=</span> <span class='st'>"km"</span><span class='op'>)</span>

<span class='fu'>sa_pressure_trans</span><span class='op'>(</span>height_in <span class='op'>=</span> <span class='st'>"km"</span>, pressure_in <span class='op'>=</span> <span class='st'>"hPa"</span><span class='op'>)</span>

<span class='fu'>sa_height_breaks</span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>6</span>, pressure_in <span class='op'>=</span> <span class='st'>"hPa"</span>, height_in <span class='op'>=</span> <span class='st'>"km"</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>sa_height_axis</span><span class='op'>(</span>
  name <span class='op'>=</span> <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/waiver.html'>waiver</a></span><span class='op'>(</span><span class='op'>)</span>,
  breaks <span class='op'>=</span> <span class='fu'>sa_height_breaks</span><span class='op'>(</span>pressure_in <span class='op'>=</span> <span class='va'>pressure_in</span>, height_in <span class='op'>=</span> <span class='va'>height_in</span><span class='op'>)</span>,
  labels <span class='op'>=</span> <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/waiver.html'>waiver</a></span><span class='op'>(</span><span class='op'>)</span>,
  guide <span class='op'>=</span> <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/waiver.html'>waiver</a></span><span class='op'>(</span><span class='op'>)</span>,
  pressure_in <span class='op'>=</span> <span class='st'>"hPa"</span>,
  height_in <span class='op'>=</span> <span class='st'>"km"</span>
<span class='op'>)</span>

<span class='fu'>sa_pressure_axis</span><span class='op'>(</span>
  name <span class='op'>=</span> <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/waiver.html'>waiver</a></span><span class='op'>(</span><span class='op'>)</span>,
  breaks <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/breaks_log.html'>log_breaks</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>6</span><span class='op'>)</span>,
  labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/label_number.html'>number_format</a></span><span class='op'>(</span>drop0trailing <span class='op'>=</span> <span class='cn'>TRUE</span>, big.mark <span class='op'>=</span> <span class='st'>""</span>, trim <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>,
  guide <span class='op'>=</span> <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/waiver.html'>waiver</a></span><span class='op'>(</span><span class='op'>)</span>,
  height_in <span class='op'>=</span> <span class='st'>"km"</span>,
  pressure_in <span class='op'>=</span> <span class='st'>"hPa"</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>height</th>
      <td><p>height in meter</p></td>
    </tr>
    <tr>
      <th>pressure</th>
      <td><p>pressure in pascals</p></td>
    </tr>
    <tr>
      <th>height_in, pressure_in</th>
      <td><p>units of height and pressure, respectively.
Possible values are "km", "m" for height and "hPa" and "Pa" for pressure.
Alternatively, it can be a numeric constant that multiplied to convert the
unit to meters and Pascals respectively. (E.g. if height is in feet,
use <code>height_in = 0.3048</code>.)</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>desiderd number of breaks.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>extra arguments passed to <a href='https://scales.r-lib.org/reference/breaks_extended.html'>scales::breaks_extended</a>.</p></td>
    </tr>
    <tr>
      <th>name, breaks, labels, guide</th>
      <td><p>arguments passed to <code><a href='https://ggplot2.tidyverse.org/reference/sec_axis.html'>ggplot2::sec_axis()</a></code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>sa_pressure()</code>, <code>sa_height()</code>, <code>sa_temperature()</code> return, respectively,
pressure (in pascals), height (in meters) and temperature (in Kelvin).</p>
<p><code>sa_height_trans()</code> and <code>sa_pressure_trans()</code> are two transformation functions
to be used as the <code>trans</code> argument in ggplot2 scales (e.g. <code>scale_y_continuous(trans = "sa_height"</code>).</p>
<p><code>sa_height_axis()</code>  and <code>sa_pressure_axis()</code> return a secondary axis that transforms to
height or pressure respectively to be used as ggplot2 secondary axis
(e.g. <code><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous(sec.axis = sa_height_axis())</a></code>).</p>
<p>For convenience, and unlike the "primitive" functions, both the transformation
functions and the axis functions input and output in hectopascals and kilometres
by default.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Standard atmosphere—Glossary of Meteorology. (n.d.).
Retrieved 22 February 2021, from <a href='https://glossary.ametsoc.org/wiki/Standard_atmosphere'>https://glossary.ametsoc.org/wiki/Standard_atmosphere</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>height</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>100</span><span class='op'>*</span><span class='fl'>1000</span>, by <span class='op'>=</span> <span class='fl'>1</span><span class='op'>*</span><span class='fl'>200</span><span class='op'>)</span>

<span class='co'># Temperature profile that defines the standard atmosphere (in degrees Celsius)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>sa_temperature</span><span class='op'>(</span><span class='va'>height</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>273.15</span>, <span class='va'>height</span>, type <span class='op'>=</span> <span class='st'>"l"</span><span class='op'>)</span>
</div><div class='img'><img src='standard_atmosphere-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Pressure profile</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>sa_pressure</span><span class='op'>(</span><span class='va'>height</span><span class='op'>)</span>, <span class='va'>height</span>, type <span class='op'>=</span> <span class='st'>"l"</span><span class='op'>)</span>
</div><div class='img'><img src='standard_atmosphere-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Use with ggplot2</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>
<span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>height <span class='op'>=</span> <span class='va'>height</span><span class='op'>/</span><span class='fl'>1000</span>,               <span class='co'># height in kilometers</span>
                   pressure <span class='op'>=</span> <span class='fu'>sa_pressure</span><span class='op'>(</span><span class='va'>height</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>100</span><span class='op'>)</span> <span class='co'># pressures in hectopascals</span>

<span class='co'># With the sa_*_axis functions, you can label the approximate height</span>
<span class='co'># when using isobaric coordinates#'</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>data</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>height</span>, <span class='va'>pressure</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_path</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>sec.axis <span class='op'>=</span> <span class='fu'>sa_height_axis</span><span class='op'>(</span><span class='st'>"height"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='standard_atmosphere-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Or the approximate pressure when using physical height</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>data</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>pressure</span>, <span class='va'>height</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_path</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>sec.axis <span class='op'>=</span> <span class='fu'>sa_pressure_axis</span><span class='op'>(</span><span class='st'>"level"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='standard_atmosphere-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># When working with isobaric coordinates,using a linear scale exagerates</span>
<span class='co'># the thickness of the lower levels</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>temperature</span><span class='op'>[</span><span class='va'>lat</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>]</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>lon</span>, <span class='va'>lev</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
   <span class='fu'><a href='geom_contour_fill.html'>geom_contour_fill</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>z <span class='op'>=</span> <span class='va'>air</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_reverse</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='img'><img src='standard_atmosphere-5.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Using the standard atmospehre height transormation, the result</span>
<span class='co'># is an approximate linear scale in height</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>temperature</span><span class='op'>[</span><span class='va'>lat</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>]</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>lon</span>, <span class='va'>lev</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
   <span class='fu'><a href='geom_contour_fill.html'>geom_contour_fill</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>z <span class='op'>=</span> <span class='va'>air</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>trans <span class='op'>=</span> <span class='st'>"sa_height"</span>, expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='standard_atmosphere-6.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># The result is very similar to using a reverse log transform, which is the</span>
<span class='co'># current behaviour of scale_y_level(). This transformation slightly</span>
<span class='co'># overextends the higher levels.</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>temperature</span><span class='op'>[</span><span class='va'>lat</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>]</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>lon</span>, <span class='va'>lev</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
   <span class='fu'><a href='geom_contour_fill.html'>geom_contour_fill</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>z <span class='op'>=</span> <span class='va'>air</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
   <span class='fu'><a href='scale_longitude.html'>scale_y_level</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='img'><img src='standard_atmosphere-7.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Elio Campitelli.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


