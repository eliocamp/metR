<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Thermodynamics — thermodynamics • metR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Thermodynamics — thermodynamics"><meta property="og:description" content="Functions related to common atmospheric thermodynamic relationships."><meta property="og:image" content="https://eliocamp.github.io/metR/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">metR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.17.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Visualization-tools.html">Visualization tools</a>
    </li>
    <li>
      <a href="../articles/Working-with-data.html">Working with data</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/eliocamp/metR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Thermodynamics</h1>
    <small class="dont-index">Source: <a href="https://github.com/eliocamp/metR/blob/master/R/IdealGas.R" class="external-link"><code>R/IdealGas.R</code></a></small>
    <div class="hidden name"><code>thermodynamics.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Functions related to common atmospheric thermodynamic relationships.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">IdealGas</span><span class="op">(</span><span class="va">p</span>, <span class="va">t</span>, <span class="va">rho</span>, R <span class="op">=</span> <span class="fl">287.058</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">Adiabat</span><span class="op">(</span><span class="va">p</span>, <span class="va">t</span>, <span class="va">theta</span>, p0 <span class="op">=</span> <span class="fl">1e+05</span>, kappa <span class="op">=</span> <span class="fl">2</span><span class="op">/</span><span class="fl">7</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">VirtualTemperature</span><span class="op">(</span><span class="va">p</span>, <span class="va">t</span>, <span class="va">e</span>, <span class="va">tv</span>, epsilon <span class="op">=</span> <span class="fl">0.622</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">MixingRatio</span><span class="op">(</span><span class="va">p</span>, <span class="va">e</span>, <span class="va">w</span>, epsilon <span class="op">=</span> <span class="fl">0.622</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ClausiusClapeyron</span><span class="op">(</span><span class="va">t</span>, <span class="va">es</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">DewPoint</span><span class="op">(</span><span class="va">p</span>, <span class="va">ws</span>, <span class="va">td</span>, epsilon <span class="op">=</span> <span class="fl">0.622</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>pressure</p></dd>


<dt id="arg-t">t<a class="anchor" aria-label="anchor" href="#arg-t"></a></dt>
<dd><p>temperature</p></dd>


<dt id="arg-rho">rho<a class="anchor" aria-label="anchor" href="#arg-rho"></a></dt>
<dd><p>density</p></dd>


<dt id="arg-r">R<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>gas constant for air</p></dd>


<dt id="arg-theta">theta<a class="anchor" aria-label="anchor" href="#arg-theta"></a></dt>
<dd><p>potential temperature</p></dd>


<dt id="arg-p-">p0<a class="anchor" aria-label="anchor" href="#arg-p-"></a></dt>
<dd><p>reference pressure</p></dd>


<dt id="arg-kappa">kappa<a class="anchor" aria-label="anchor" href="#arg-kappa"></a></dt>
<dd><p>ratio of dry air constant and specific heat capacity at constant pressure</p></dd>


<dt id="arg-e">e<a class="anchor" aria-label="anchor" href="#arg-e"></a></dt>
<dd><p>vapour partial pressure</p></dd>


<dt id="arg-tv">tv<a class="anchor" aria-label="anchor" href="#arg-tv"></a></dt>
<dd><p>virtual temperature</p></dd>


<dt id="arg-epsilon">epsilon<a class="anchor" aria-label="anchor" href="#arg-epsilon"></a></dt>
<dd><p>ratio of dry air constant and vapour constant</p></dd>


<dt id="arg-w">w<a class="anchor" aria-label="anchor" href="#arg-w"></a></dt>
<dd><p>mixing ratio</p></dd>


<dt id="arg-es">es<a class="anchor" aria-label="anchor" href="#arg-es"></a></dt>
<dd><p>saturation vapour partial pressure</p></dd>


<dt id="arg-ws">ws<a class="anchor" aria-label="anchor" href="#arg-ws"></a></dt>
<dd><p>saturation mixing ratio</p></dd>


<dt id="arg-td">td<a class="anchor" aria-label="anchor" href="#arg-td"></a></dt>
<dd><p>dewpoint</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Each function returns the value of the missing state variable.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><code>IdealGas</code> computes pressure, temperature or density of air according to the
ideal gas law \(P=\rho R T\).</p>
<p><code>Adiabat</code> computes pressure, temperature or potential temperature according to
the adiabatic relationship \(\theta = T (P0/P)^\kappa\).</p>
<p><code>VirtualTemperature</code> computes pressure, temperature, vapour partial pressure or
virtual temperature according to the virtual temperature definition
\(T(1 - e/P(1 - \epsilon))^{-1}\).</p>
<p><code>MixingRatio</code> computes pressure, vapour partial temperature, or mixing ratio
according to \(w = \epsilon e/(P - e)\).</p>
<p><code>ClausiusClapeyron</code> computes saturation pressure or temperature according
to the August-Roche-Magnus formula \(es = a exp{bT/(T + c)}\) with temperature
in Kelvin and saturation pressure in Pa.</p>
<p><code>DewPoint</code> computes pressure, saturation mixing ration or dew point
from the relationship \(ws =  \epsilon es(Td)/(p - es(Td))\). Note that the
computation of dew point is approximated.</p>
<p>Is important to take note of the units in which each variable is provided.
With the default values, pressure should be passed in Pascals, temperature and
potential temperature in Kelvins, and density in \(kg/m^3\).
<code>ClausiusClayperon</code> and <code>DewPoint</code> require and return values in those units.</p>
<p>The defaults value of the <code>R</code> and <code>kappa</code> parameters are correct for dry air,
for the case of moist air, use the virtual temperature instead of the actual
temperature.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>http://www.atmo.arizona.edu/students/courselinks/fall11/atmo551a/ATMO_451a_551a_files/WaterVapor.pdf</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other meteorology functions:
<code><a href="Derivate.html">Derivate</a>()</code>,
<code><a href="EOF.html">EOF</a>()</code>,
<code><a href="GeostrophicWind.html">GeostrophicWind</a>()</code>,
<code><a href="WaveFlux.html">WaveFlux</a>()</code>,
<code><a href="waves.html">waves</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">IdealGas</span><span class="op">(</span><span class="fl">1013</span><span class="op">*</span><span class="fl">100</span>, <span class="fl">20</span> <span class="op">+</span> <span class="fl">273.15</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.203788</span>
<span class="r-in"><span><span class="fu">IdealGas</span><span class="op">(</span><span class="fl">1013</span><span class="op">*</span><span class="fl">100</span>, rho <span class="op">=</span> <span class="fl">1.15</span><span class="op">)</span> <span class="op">-</span> <span class="fl">273.15</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 33.71118</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu">Adiabat</span><span class="op">(</span><span class="fl">70000</span>, <span class="fl">20</span> <span class="op">+</span> <span class="fl">273.15</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 324.5993</span>
<span class="r-in"><span><span class="fu">Adiabat</span><span class="op">(</span><span class="fl">70000</span>, theta <span class="op">=</span> <span class="va">theta</span><span class="op">)</span> <span class="op">-</span> <span class="fl">273.15</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Relative humidity from T and Td</span></span></span>
<span class="r-in"><span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fl">25</span> <span class="op">+</span> <span class="fl">273.15</span></span></span>
<span class="r-in"><span><span class="va">td</span> <span class="op">&lt;-</span> <span class="fl">20</span> <span class="op">+</span> <span class="fl">273.15</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">1000000</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">rh</span> <span class="op">&lt;-</span> <span class="fu">ClausiusClapeyron</span><span class="op">(</span><span class="va">td</span><span class="op">)</span><span class="op">/</span><span class="fu">ClausiusClapeyron</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.7380251</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Mixing ratio</span></span></span>
<span class="r-in"><span><span class="va">ws</span> <span class="op">&lt;-</span> <span class="fu">MixingRatio</span><span class="op">(</span><span class="va">p</span>, <span class="fu">ClausiusClapeyron</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">w</span> <span class="op">&lt;-</span> <span class="va">ws</span><span class="op">*</span><span class="va">rh</span></span></span>
<span class="r-in"><span><span class="fu">DewPoint</span><span class="op">(</span><span class="va">p</span>, <span class="va">w</span><span class="op">)</span> <span class="op">-</span> <span class="fl">273.15</span>    <span class="co"># Recover Td</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20.01339</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Elio Campitelli.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

