<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Thermodynamics — thermodynamics • metR</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Thermodynamics — thermodynamics"><meta name="description" content="Functions related to common atmospheric thermodynamic relationships."><meta property="og:description" content="Functions related to common atmospheric thermodynamic relationships."><meta property="og:image" content="https://eliocamp.github.io/metR/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">metR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.18.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Visualization-tools.html">Visualization tools</a></li>
    <li><a class="dropdown-item" href="../articles/Working-with-data.html">Working with data</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/eliocamp/metR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Thermodynamics</h1>
      <small class="dont-index">Source: <a href="https://github.com/eliocamp/metR/blob/master/R/IdealGas.R" class="external-link"><code>R/IdealGas.R</code></a></small>
      <div class="d-none name"><code>thermodynamics.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Functions related to common atmospheric thermodynamic relationships.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">IdealGas</span><span class="op">(</span><span class="va">p</span>, <span class="va">t</span>, <span class="va">rho</span>, R <span class="op">=</span> <span class="fl">287.058</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">Adiabat</span><span class="op">(</span><span class="va">p</span>, <span class="va">t</span>, <span class="va">theta</span>, p0 <span class="op">=</span> <span class="fl">1e+05</span>, kappa <span class="op">=</span> <span class="fl">2</span><span class="op">/</span><span class="fl">7</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">VirtualTemperature</span><span class="op">(</span><span class="va">p</span>, <span class="va">t</span>, <span class="va">e</span>, <span class="va">tv</span>, epsilon <span class="op">=</span> <span class="fl">0.622</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">MixingRatio</span><span class="op">(</span><span class="va">p</span>, <span class="va">e</span>, <span class="va">w</span>, epsilon <span class="op">=</span> <span class="fl">0.622</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ClausiusClapeyron</span><span class="op">(</span><span class="va">t</span>, <span class="va">es</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">DewPoint</span><span class="op">(</span><span class="va">p</span>, <span class="va">ws</span>, <span class="va">td</span>, epsilon <span class="op">=</span> <span class="fl">0.622</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>pressure</p></dd>


<dt id="arg-t">t<a class="anchor" aria-label="anchor" href="#arg-t"></a></dt>
<dd><p>temperature</p></dd>


<dt id="arg-rho">rho<a class="anchor" aria-label="anchor" href="#arg-rho"></a></dt>
<dd><p>density</p></dd>


<dt id="arg-r">R<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>gas constant for air</p></dd>


<dt id="arg-theta">theta<a class="anchor" aria-label="anchor" href="#arg-theta"></a></dt>
<dd><p>potential temperature</p></dd>


<dt id="arg-p-">p0<a class="anchor" aria-label="anchor" href="#arg-p-"></a></dt>
<dd><p>reference pressure</p></dd>


<dt id="arg-kappa">kappa<a class="anchor" aria-label="anchor" href="#arg-kappa"></a></dt>
<dd><p>ratio of dry air constant and specific heat capacity at constant pressure</p></dd>


<dt id="arg-e">e<a class="anchor" aria-label="anchor" href="#arg-e"></a></dt>
<dd><p>vapour partial pressure</p></dd>


<dt id="arg-tv">tv<a class="anchor" aria-label="anchor" href="#arg-tv"></a></dt>
<dd><p>virtual temperature</p></dd>


<dt id="arg-epsilon">epsilon<a class="anchor" aria-label="anchor" href="#arg-epsilon"></a></dt>
<dd><p>ratio of dry air constant and vapour constant</p></dd>


<dt id="arg-w">w<a class="anchor" aria-label="anchor" href="#arg-w"></a></dt>
<dd><p>mixing ratio</p></dd>


<dt id="arg-es">es<a class="anchor" aria-label="anchor" href="#arg-es"></a></dt>
<dd><p>saturation vapour partial pressure</p></dd>


<dt id="arg-ws">ws<a class="anchor" aria-label="anchor" href="#arg-ws"></a></dt>
<dd><p>saturation mixing ratio</p></dd>


<dt id="arg-td">td<a class="anchor" aria-label="anchor" href="#arg-td"></a></dt>
<dd><p>dewpoint</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Each function returns the value of the missing state variable.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>IdealGas</code> computes pressure, temperature or density of air according to the
ideal gas law \(P=\rho R T\).</p>
<p><code>Adiabat</code> computes pressure, temperature or potential temperature according to
the adiabatic relationship \(\theta = T (P0/P)^\kappa\).</p>
<p><code>VirtualTemperature</code> computes pressure, temperature, vapour partial pressure or
virtual temperature according to the virtual temperature definition
\(T(1 - e/P(1 - \epsilon))^{-1}\).</p>
<p><code>MixingRatio</code> computes pressure, vapour partial temperature, or mixing ratio
according to \(w = \epsilon e/(P - e)\).</p>
<p><code>ClausiusClapeyron</code> computes saturation pressure or temperature according
to the August-Roche-Magnus formula \(es = a exp{bT/(T + c)}\) with temperature
in Kelvin and saturation pressure in Pa.</p>
<p><code>DewPoint</code> computes pressure, saturation mixing ration or dew point
from the relationship \(ws =  \epsilon es(Td)/(p - es(Td))\). Note that the
computation of dew point is approximated.</p>
<p>Is important to take note of the units in which each variable is provided.
With the default values, pressure should be passed in Pascals, temperature and
potential temperature in Kelvins, and density in \(kg/m^3\).
<code>ClausiusClayperon</code> and <code>DewPoint</code> require and return values in those units.</p>
<p>The defaults value of the <code>R</code> and <code>kappa</code> parameters are correct for dry air,
for the case of moist air, use the virtual temperature instead of the actual
temperature.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>http://www.atmo.arizona.edu/students/courselinks/fall11/atmo551a/ATMO_451a_551a_files/WaterVapor.pdf</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other meteorology functions:
<code><a href="Derivate.html">Derivate</a>()</code>,
<code><a href="EOF.html">EOF</a>()</code>,
<code><a href="GeostrophicWind.html">GeostrophicWind</a>()</code>,
<code><a href="WaveFlux.html">WaveFlux</a>()</code>,
<code><a href="waves.html">waves</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">IdealGas</span><span class="op">(</span><span class="fl">1013</span><span class="op">*</span><span class="fl">100</span>, <span class="fl">20</span> <span class="op">+</span> <span class="fl">273.15</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.203788</span>
<span class="r-in"><span><span class="fu">IdealGas</span><span class="op">(</span><span class="fl">1013</span><span class="op">*</span><span class="fl">100</span>, rho <span class="op">=</span> <span class="fl">1.15</span><span class="op">)</span> <span class="op">-</span> <span class="fl">273.15</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 33.71118</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu">Adiabat</span><span class="op">(</span><span class="fl">70000</span>, <span class="fl">20</span> <span class="op">+</span> <span class="fl">273.15</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 324.5993</span>
<span class="r-in"><span><span class="fu">Adiabat</span><span class="op">(</span><span class="fl">70000</span>, theta <span class="op">=</span> <span class="va">theta</span><span class="op">)</span> <span class="op">-</span> <span class="fl">273.15</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Relative humidity from T and Td</span></span></span>
<span class="r-in"><span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fl">25</span> <span class="op">+</span> <span class="fl">273.15</span></span></span>
<span class="r-in"><span><span class="va">td</span> <span class="op">&lt;-</span> <span class="fl">20</span> <span class="op">+</span> <span class="fl">273.15</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">1000000</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">rh</span> <span class="op">&lt;-</span> <span class="fu">ClausiusClapeyron</span><span class="op">(</span><span class="va">td</span><span class="op">)</span><span class="op">/</span><span class="fu">ClausiusClapeyron</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.7380251</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Mixing ratio</span></span></span>
<span class="r-in"><span><span class="va">ws</span> <span class="op">&lt;-</span> <span class="fu">MixingRatio</span><span class="op">(</span><span class="va">p</span>, <span class="fu">ClausiusClapeyron</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">w</span> <span class="op">&lt;-</span> <span class="va">ws</span><span class="op">*</span><span class="va">rh</span></span></span>
<span class="r-in"><span><span class="fu">DewPoint</span><span class="op">(</span><span class="va">p</span>, <span class="va">w</span><span class="op">)</span> <span class="op">-</span> <span class="fl">273.15</span>    <span class="co"># Recover Td</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20.01339</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Elio Campitelli.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

